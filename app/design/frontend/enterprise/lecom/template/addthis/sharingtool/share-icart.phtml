<?php
/*
 * Copyright (C) 2012 Clearspring Technologies, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
?>
<?php
/**General Options*/
	$plugin_enabled   	  = $this->getPluginEnabledStatus();
	$pubid 			  	  = $this->getPubId();
	
/**Custom Share*/		
	$custom_url 	     = $this->getCustomUrl();
	$custom_title 	     = $this->getCustomTitle();	
	$custom_description  = $this->getCustomDescription();
	$custom_share		 = "addthis:url='".$custom_url."' addthis:title='".$custom_title."' addthis:description='".$custom_description."'";			
	
/**API COnfig Options*/	
	$services_exclude 	  = $this->getExcludeServices();
	$services_compact 	  = $this->getCompactServices();
	$services_expanded 	  = $this->getExpandedServices();
	$ui_click 			  = $this->getUiClick();
	$ui_delay 			  = $this->getUiDelay();
	$ui_hover_direction   = $this->getUiHover();
	$ui_open_windows 	  = $this->getUiOpenWindows();
	$ui_language 		  = $this->getUiLanguage();
	$ui_offset_top 		  = $this->getUiOffsetTop();
	$ui_offset_left 	  = $this->getUiOffsetLeft();
	$ui_cobrand 		  = $this->getUiCobrand();
	$ui_use_css 		  = $this->getUiCss();
	$ui_use_addressbook   = $this->getUiAddressBook();
	$ui_508_compliant 	  = $this->getUiCompliant();
	$data_track_clickback = $this->getDataTrackClick();
	$address_bar_share	  = $this->getAddressBarShare();	
	$data_ga_tracker 	  = $this->getDataGaTracker();

	
/**Custom Service*/
	$services_custom_name = $this->getCustomServiceName();
	$services_custom_url  = $this->getCustomServiceUrl();
	$services_custom_icon = $this->getCustomServiceIcon();	
	
?>
<!-- Check whether the plugin is enabled -->
<?php
	if($plugin_enabled!=0):
?>

<!-- AddThis Button BEGIN -->

<?php
	$productId = Mage::app()->getRequest()->getParam('product');
	
	$product = Mage::getModel('catalog/product')->load($productId);
	$prodDesc = 'American Swan';
    
	if($product){
		$currentUrl = $product->getProductUrl();
		$custom_share = "addthis:url='".$currentUrl."'addthis:title='".$custom_title."'addthis:description='".$custom_description."'";
		$prodDesc = $product->getProductDescription();
	}
	$button_style = $this->getButtonStyle();
    switch($button_style)
    {
    case 'style_1':               
?>
<div class="addthis_toolbox addthis_default_style " <?php echo $custom_share?>>
<!-- <a class="addthis_button_facebook_like" /> ;-->
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
<?php
 	break; 	
 	case 'style_2':
 ?>
<div class="addthis_toolbox addthis_default_style " <?php echo $custom_share?>>
<a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
<a class="addthis_button_tweet"></a>
<a class="addthis_counter addthis_pill_style"></a>
</div>
<?php
 	break; 	
 	case 'style_4':
?>
<div class="addthis_toolbox addthis_default_style " <?php echo $custom_share?>>
<a href="http://www.addthis.com/bookmark.php?v=250&amp;pubid=xa-4f0d95b663c861f6" class="addthis_button_compact">Share</a>
<span class="addthis_separator">|</span>
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
</div>
<?php
 	break; 	
 	case 'style_5':
?>
<div class="addthis_toolbox addthis_default_style " <?php echo $custom_share?>>
<a href="http://www.addthis.com/bookmark.php?v=250&amp;pubid=xa-4f0d960e09c42ec4" class="addthis_button_compact">Share</a>
</div>
<?php
 	break; 	
 	case 'style_6':
?>
<div class="addthis_toolbox addthis_default_style " <?php echo $custom_share?>>
<a class="addthis_counter addthis_pill_style"></a>
</div>
<?php
 	break; 	
 	case 'style_7':
?>
<div class="addthis_toolbox addthis_default_style " <?php echo $custom_share?>>
<a class="addthis_counter"></a>
</div>
<?php
 	break; 	
 	case 'style_8':
?>
<a class="addthis_button" href="http://www.addthis.com/bookmark.php?v=250" <?php echo $custom_share?>>
<img src="http://s7.addthis.com/static/btn/sm-plus.gif" alt="Bookmark and Share" style="border:0"/></a>
<?php
 	break;
 	case 'style_9':
?>
<div class="addthis_toolbox addthis_default_style" <?php echo $custom_share?>>
<a class="addthis_button_email" id="email_msg" title="Email"></a>
<a class="addthis_button_twitter" id="twitter_msg" title="Twitter"></a>
<a class="addthis_button_pinterest_share" id="pinterest_msg" title="Pinterest"></a>
<?php echo $this->getLayout()->createBlock('evlike/like')->setTemplate('evlike/likebutton.phtml')->_toHtml(); ?>
</div>

<?php
	break; 	
 	case 'style_10':
 	$custom_button_url = Mage::getStoreConfig('sharing_tool/button_style/custom_button_url');
?>	

<a class="addthis_button" href="http://www.addthis.com/bookmark.php?v=250" <?php echo $custom_share?>>
<img src="<?php echo $custom_button_url ?>" alt="Bookmark and Share" style="border:0"/></a>

<?php
 	break; 	
 	default:
?>

<div class="addthis_toolbox addthis_default_style addthis_32x32_style" <?php echo $custom_share?>>
<a class="addthis_button_facebook_like" />
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>  
<?php
 }//switch ends	
?>

<script type="text/javascript">/* (c) 2008-2012 Add This, LLC */
if(!((window._atc||{}).ver)){var _atd="www.addthis.com/",_atr="//s7.addthis.com/",_euc=encodeURIComponent,_duc=decodeURIComponent,_atc={dbg:0,rrev:117543,dr:0,ver:250,loc:0,enote:"",cwait:500,bamp:0.25,camp:1,csmp:0.0001,damp:0,famp:0.02,pamp:0.2,tamp:1,lamp:1,plmp:0.00001,vamp:1,vrmp:0.0001,ohmp:0,ltj:1,xamp:1,abf:!!window.addthis_do_ab,qs:0,cdn:0,rsrcs:{bookmark:_atr+"static/r07/bookmark024.html",atimg:_atr+"static/r07/atimg024.html",countercss:_atr+"static/r07/counter003.css",counterIE67css:_atr+"static/r07/counterIE67002.css",counter:_atr+"static/r07/counter004.js",core:_atr+"static/r07/core043.js",wombat:_atr+"static/r07/bar011.js",qbarcss:_atr+"bannerQuirks.css",fltcss:_atr+"static/r07/floating003.css",barcss:_atr+"static/r07/banner004.css",barjs:_atr+"static/r07/banner001.js",contentcss:_atr+"static/r07/content005C.css",contentjs:_atr+"static/r07/content006C.js",copythis:_atr+"static/r07/copythis00B.js",copythiscss:_atr+"static/r07/copythis00B.css",ssojs:_atr+"static/r07/ssi004.js",ssocss:_atr+"static/r07/ssi004.css",authjs:_atr+"static/r07/auth006.js",peekaboocss:_atr+"static/r07/peekaboo002.css",overlayjs:_atr+"static/r07/overlay005.js",widget32css:_atr+"static/r07/widgetbig047.css",widget20css:_atr+"static/r07/widgetmed000.css",widgetcss:_atr+"static/r07/widget096.css",widgetIE67css:_atr+"static/r07/widgetIE67005.css",widgetpng:"//s7.addthis.com/static/r07/widget047.png",embed:_atr+"static/r07/embed000.js",link:_atr+"static/r07/link005.html",pinit:_atr+"static/r07/pinit006.html",linkedin:_atr+"static/r07/linkedin020.html",fbshare:_atr+"static/r07/fbshare001.html",tweet:_atr+"static/r07/tweet023.html",menujs:_atr+"static/r07/menu129.js",sh:_atr+"static/r07/sh102.html"}};}(function(){var g;var p=(window.location.protocol=="https:"),D,m,z=(navigator.userAgent||"unk").toLowerCase(),v=(/firefox/.test(z)),o=(/msie/.test(z)&&!(/opera/.test(z))),c={0:_atr,1:"//ct1.addthis.com/",2:"//ct2.addthis.com/",3:"//ct3.addthis.com/",4:"//ct4.addthis.com/",5:"//ct5.addthis.com/",100:"//ct0.addthis.com/"},C={au:"1",hk:"1",is:"1",id:"1",jp:"1",my:"1",ph:"1",sg:"1",kr:"1",ch:"1",tw:"1",th:"1",tr:"1",ru:"1",vn:"1"},E={de:"1",es:"1"},j={no:"1",pl:"1"},f={be:"1",ca:"1",fr:"1",mx:"1",nl:"1",no:"1",pl:"1",gb:"1",us:"1"},n={at:"1",cz:"1",dk:"1",fi:"1",gr:"1",hu:"1",it:"1",pt:"1",ro:"1",se:"1",ua:"1"};_atc.cdn=0;if(!window.addthis||window.addthis.nodeType!==g){try{D=window.navigator?(navigator.userLanguage||navigator.language):"";m=D.split("-").pop().toLowerCase();if(m.length!=2){m="unk";}if(p||_atr.indexOf("-")>-1){}else{if(window.addthis_cdn!==g){_atc.cdn=window.addthis_cdn;}else{if(C[m]){_atc.cdn=5;}else{if(f[m]){_atc.cdn=(v||o)?5:1;}else{if(E[m]){_atc.cdn=(o||(/chrome/.test(z)))?5:1;}else{if(j[m]){_atc.cdn=v?5:1;}else{if(n[m]){_atc.cdn=(o)?5:1;}}}}}}}if(_atc.cdn){for(var y in _atc.rsrcs){if(_atc.rsrcs.hasOwnProperty(y)){_atc.rsrcs[y]=_atc.rsrcs[y].replace(_atr,c[_atc.cdn]).replace(/live\/([a-z])07/,"live/$107");}}_atr=c[_atc.cdn];}}catch(A){}function b(r,k,e,a){return function(){if(!this.qs){this.qs=0;}_atc.qs++;if(!((this.qs++>0&&a)||_atc.qs>1000)&&window.addthis){window.addthis.plo.push({call:r,args:arguments,ns:k,ctx:e});}};}function x(k){var e=this,a=this.queue=[];this.name=k;this.call=function(){a.push(arguments);};this.call.queuer=this;this.flush=function(F,s){this.flushed=1;for(var r=0;r<a.length;r++){F.apply(s||e,a[r]);}return F;};}window.addthis={ost:0,cache:{},plo:[],links:[],ems:[],timer:{load:((new Date()).getTime())},_Queuer:x,_queueFor:b,data:{getShareCount:b("getShareCount","data")},bar:{show:b("show","bar"),initialize:b("initialize","bar")},login:{initialize:b("initialize","login"),connect:b("connect","login")},configure:function(r){if(!w.addthis_config){w.addthis_config={};}if(!w.addthis_share){w.addthis_share={};}for(var a in r){if(a=="share"&&typeof(r[a])=="object"){for(var e in r[a]){if(r[a].hasOwnProperty(e)){if(!addthis.ost){w.addthis_share[e]=r[a][e];}else{addthis.update("share",e,r[a][e]);}}}}else{if(r.hasOwnProperty(a)){if(!addthis.ost){w.addthis_config[a]=r[a];}else{addthis.update("config",a,r[a]);}}}}},box:b("box"),button:b("button"),counter:b("counter"),count:b("count"),toolbox:b("toolbox"),update:b("update"),init:b("init"),ad:{menu:b("menu","ad","ad"),event:b("event","ad"),getPixels:b("getPixels","ad")},util:{getServiceName:b("getServiceName")},ready:b("ready"),addEventListener:b("addEventListener","ed","ed"),removeEventListener:b("removeEventListener","ed","ed"),user:{getID:b("getID","user"),getGeolocation:b("getGeolocation","user",null,true),getPreferredServices:b("getPreferredServices","user",null,true),getServiceShareHistory:b("getServiceShareHistory","user",null,true),ready:b("ready","user"),isReturning:b("isReturning","user"),isOptedOut:b("isOptedOut","user"),isUserOf:b("isUserOf","user"),hasInterest:b("hasInterest","user"),isLocatedIn:b("isLocatedIn","user"),interests:b("getInterests","user"),services:b("getServices","user"),location:b("getLocation","user")},session:{source:b("getSource","session"),isSocial:b("isSocial","session"),isSearch:b("isSearch","session")},_pmh:new x("pmh")};var t=document.getElementsByTagName("script")[0];function d(a){a.style.width=a.style.height="1px";a.style.position="absolute";a.style.zIndex=100000;}if(document.location.href.indexOf(_atr)==-1){var q=document.getElementById("_atssh");if(!q){q=document.createElement("div");q.style.visibility="hidden";q.id="_atssh";d(q);t.parentNode.appendChild(q);}function h(a){if(a&&!(a.data||{})["addthisxf"]){if(addthis._pmh.flushed){_ate.pmh(a);}else{addthis._pmh.call(a);}}}if(window.postMessage){if(window.attachEvent){window.attachEvent("onmessage",h);}else{if(window.addEventListener){window.addEventListener("message",h,false);}}}if(!q.firstChild){var i,z=navigator.userAgent.toLowerCase(),u=Math.floor(Math.random()*1000);if(o){q.innerHTML="<iframe id=\"_atssh"+u+"\" width=\"1\" height=\"1\" title=\"AddThis utility frame\" name=\"_atssh"+u+"\" src=\"\">";i=document.getElementById("_atssh"+u);}else{i=document.createElement("iframe");i.id="_atssh"+u;i.title="AddThis utility frame";q.appendChild(i);}d(i);i.frameborder=i.style.border=0;i.style.top=i.style.left=0;_atc._atf=i;}}var B=document.createElement("script");B.type="text/javascript";B.src=(p?"https:":"http:")+_atc.rsrcs.core;t.parentNode.appendChild(B);var l=10000;setTimeout(function(){if(!window.addthis.timer.core){if(Math.random()<_atc.ohmp){(new Image()).src="//m.addthisedge.com/live/t00/oh.gif?"+Math.floor(Math.random()*4294967295).toString(36)+"&cdn="+_atc.cdn+"&sr="+_atc.ohmp+"&rev="+_atc.rrev+"&to="+l;}if(_atc.cdn!==0){var e=document.createElement("script");e.type="text/javascript";e.src=(p?"https:":"http:")+_atr+"static/r07/core043.js";t.parentNode.appendChild(e);}}},l);}})();</script>


<!-- AddThis Button END -->

<?php
endif; //if plugin not enabled
?>

<?php
	if($button_style=='style_9') {
?>
<style type="text/css">
	.at300bs { background :none !important; }
	.at16nc { background :none !important; }	
</style>
<?php
	}
?>
